---
layout: default
title: Verification
type: Homework
number: 05
active_tab: homework
release_date: 2024-02-29
due_date: 2024-03-17 23:59:00EDT

---

<!-- Check whether the assignment is ready to release -->
{% capture today %}{{'now' | date: '%s'}}{% endcapture %}
{% capture release_date %}{{page.release_date | date: '%s'}}{% endcapture %}
{% if release_date > today %} 
<div class="alert alert-danger">
Warning: this assignment is out of date.  It may still need to be updated for this year's class.  Check with your instructor before you start working on this assignment.
</div>
{% endif %}
<!-- End of check whether the assignment is up to date -->


<!-- Check whether the assignment is up to date -->
{% capture this_year %}{{'now' | date: '%Y'}}{% endcapture %}
{% capture due_year %}{{page.due_date | date: '%Y'}}{% endcapture %}
{% if this_year != due_year %} 
<div class="alert alert-danger">
Warning: this assignment is out of date.  It may still need to be updated for this year's class.  Check with your instructor before you start working on this assignment.
</div>
{% endif %}
<!-- End of check whether the assignment is up to date -->



{% if page.materials %}
<div class="alert alert-info">
You can download the materials for this assignment here:
<ul>
{% for item in page.materials %}
<li><a href="{{item.url}}">{{ item.name }}</a></li>
{% endfor %}
</ul>


<i>Remember to make a copy of the notebook into your own Drive by choosing “Save a Copy in Drive” from Colab’s “File” menu.</i>

</div>
{% endif %}





{{page.type}} {{page.number}}: {{page.title}}
=============================================================

_Due: {{page.due_date}}_

## Overview
For this assignment you will implement the Davis-Putnam-Logemann-Loveland (DPLL) search algorithm for deciding the satisfiability of propositional logic formulae. This assignment consists of four parts. The first part will involve querying Z3 Theorem Prover, a SMT solver developed by Microsoft. Part two will inolve converting propositions to Conjunctive Normal Form (CNF). You will work through examples by hand as well as programming a function to rewrite propositions in CNF. In Part three you will implement DPLL for boolean satisfiability. Since DPLL requires CNF propositions, you will use your function you wrote in part two. In part four, you will extend your DPLL algorithm to DPLL+Theory (DPLL+T) by implementing the Simplex Algorithm for Linear Algebra. 

## Resources
1. [Z3 Java Documentation](https://z3prover.github.io/api/html/classcom_1_1microsoft_1_1z3_1_1_context.html)
2. [Z3 Java Example](https://github.com/Z3Prover/z3/blob/master/examples/java/JavaExample.java)

## Part 1. Querying Z3

In this part, you will use the Java Z3 library to query if a proposition is satisfiable. For 

Setup steps: 
1. Download the [latest z3 release](https://github.com/Z3Prover/z3/releases) - Download the latest zip file
2. unzip the release
3. cd into the newly unzip directory and run `mkdir bin`
4. Run `python scripts/mk_make.py --prefix=<your_z3_path>/bin --java` replacing `<your_z3_path>` with the absolute path to the directory you just unzipped.
5. run `cd build; make`
6. run `make install`. When this is done you should see a message that says "Z3 was successfully installed."
7. run `export Z3_DIR=<your_z3_path>` replacing `<your_z3_path>` with the absolute path to the directory you just unzipped.
8. run `export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$Z3_DIR/bin/lib`
9. Download the starter code for part 1: `wget https://raw.githubusercontent.com/BMC-CS-151/BMC-CS-151.github.io/main/hws/hw05/BinaryTree.java`
10. Compile it using `bash compile.sh` and run it using `bash run.sh`

### Declaring Propositions
In Z3, we declare propositions using the `Context mkBoolConst` function. The argument is the string name of that boolean variable. 

Open the given code to see an example of querying Z3 for a model of `(p V q) ^ (p V ~r)`. 
The code first creates a `Context` and `Solver`. It then creates Boolean consts for `p`, `q`, and `r`. Next it combines them using boolean operators with the `mkOr`, `mkAnd`, and `mkNot` methods. Lastly, it calls `solver.check()` to see if the given boolean proposition is satisfiable and `solver.getModel()` to return the satisfying assignment if it exists. 

### SAT or UNSAT
For each of the following propositions, use Z3 to decide if it is satisfiable. If it is satisfiable, report a valid interpretation. Otherwise, report UNSAT. 
1. ¬¬A
2. A∧¬A 
3. (A∨B)∧(¬A∨C)∧(¬B∨¬C)
4. (A∨B∨C)∧(¬A∨D)∧(¬B∨¬D)∧(C∨¬D)∧(A∨¬C)
5. (A∨B∨C)∧(¬A∨D)∧(¬B∨D)∧(¬C∨D)∧(¬D∨E)∧(A∨¬E)∧(B∨¬E)∧(C∨¬E)∧(¬A∨¬B)∧(¬B∨¬C)∧(¬A∨¬C)

For the following program, use Z3 decide if a divide by zero error may occur. 
Report the proposition you encoded as well as a valid interpretation if it is satisfiable.

You can assume x, y, and z are integers. Hint: you might want to use the `Context` methods: `mkIntConst`, `mkEq`, `mkGt` and similar.

```java
if (x > y) {
    int res = x / y;
}
```

```java
if (y > 3 * x + 7) {
    if (x + y - z % 2 == 0) {
        if (z >= x) {
            int res = z / (z - x);
        }
    }
}
```

Use Z3 to solve the following logic puzzles.
1. Seat Arrangement
2. Sodoku
3. n-Queens?

When you're done with this section, submit your code Hw5Part1.java to gradescope.
In your READEME.txt report if the 10 are SAT/UNSAT and give a satisfying assignment if they are SAT. 

## 2. Storing Polling Data
The polling data you are given will include the candidate’s full name, their last
name, and the percentage of the people polled who said they would vote for that
candidate.

### Requirements

1. Create a class to store the polling data: `PollingData.java`

2. Have your created class implement the `Comparable` interface so that polling
data objects are put in alphabetical order based on the candidate’s <i>last</i> name.

3. Override the `toString` method to return a `String` with the following for-
matting: 
```
Full Name:5.0
```
where `Full Name` is the candidate’s full name and `5.0` was the candidate’s
polling percentage.

4. Your `PollingData` class should have the following constructor:  `public PollingData(String lastName, String fullName, double percent)`

## 3. Polling Data from CSVs

The website FiveThirtyEight makes polling data for presidential primary candi-
dates available (https://data.fivethirtyeight.com/). We have preprocessed
this data for you so that only the relevant data is included and you will receive
one file per conducted poll.

You can download the polling data here: https://github.com/BMC-CS-151/BMC-CS-151.github.io/blob/main/hws/hw05/poll_data.zip   

Each polling data CSV has the following format:

```
answer,candidate_name,pct
Biden,Joseph R. Biden Jr.,25
Sanders,Bernard Sanders,16
```

The first column gives the last name of the candidate, the second column gives the
candidate’s full name, and the final column is the percent the candidate is polling
at in this poll. Note that the given percent can be a floating-point number.

Each file is named something like `dempres_20190310_1.csv` where `dempres`
indicates that these are polling results for the Democratic party presidential primary, 
`20190310` indicates that the polling results were completed on March 10,
2019, and `_1` indicates that these are the results for the first poll completed on
that date (there may be multiple from different sources).

Your job is to create a `DriverHW05.java` that takes the polling data in each file and inserts it into the binary
tree. Your resulting tree should contain the polling data for each candidate from
the most recent date for which there is data from the files given on the command
line. Each polling result will only include some of the candidates.

### Requirements:
1. Take filename input from the command line into the main method of your
DriverHW05.java. You may be given multiple filenames. An example of given 
arguments might be:
`dempres_20190210_1.csv dempres_20190210_2.csv dempres_20190310_1.csv`
or:
`dempres_20190210*.csv`.
Recall that unix shell will expand the `*` for you.

As in HW02, you must be able to handle relative paths. That is, if the csv files are not in the current directory. Ex: `DriverHW05 ../../polls/dempres_20190210_1.csv`   

3. You should process the given files in increasing date order. You may assume
that the files are given in this order.

4. Use your overridden `toString` method to print the tree after polling results
from each new date are inserted. Thus, your resulting printed information
should include one snapshot of the tree per given polling data CSV.  

5. Do not use any try-catches. The signature of your `main` function should be: `public static void main(String[] args) throws FileNotFoundException`  

## 4. Extra credit (5 points) 
All extra credit should only be done **after** successful completion of all of the base
requirements for this assignment. If you implement
the extra credit, you must add that to your README so that our grading will
know to test for them and grant credit accordingly.

1. Make sure that the polls are processed in date order no matter what order
they are given to you in on the command line.

## Sample Input and Output:

For an input file containing: 
```
answer,candidate_name,pct
Biden,Joseph R. Biden Jr.,25
Sanders,Bernard Sanders,16
Harris,Kamala D. Harris,8
Warren,Elizabeth Warren,8
O'Rourke,Beto O'Rourke,7
Booker,Cory A. Booker,5
```

The output should be:
```
Tree:
Pre: Joseph R. Biden Jr.:25.0 Bernard Sanders:16.0 Kamala D. Harris:8.0 Cory A. Booker:5.0 Beto O'Rourke:7.0 Elizabeth Warren:8.0
In: Joseph R. Biden Jr.:25.0 Cory A. Booker:5.0 Kamala D. Harris:8.0 Beto O'Rourke:7.0 Bernard Sanders:16.0 Elizabeth Warren:8.0
Post: Cory A. Booker:5.0 Beto O'Rourke:7.0 Kamala D. Harris:8.0 Elizabeth Warren:8.0 Bernard Sanders:16.0 Joseph R. Biden Jr.:25.0
```

## Submitting
Submit the following files to the assignment on Gradescope

1. README: The usual plain text file README
  - Your name
  - Discussion: Design of remove as explained above, and any extra credit
implementations you chose to do.
  - How much time you spent on the assignment
  - What did you learn?
  - (Optional): Any feedback or comments

2. Source files:
   - `LinkedBinaryTree.java`   
   - `PollingData.java`   
   - `DriverHW05.java`   
   - Any other java files you created 

Make sure to name these files exactly what we specify here. Otherwise,
our autograders might not work and we might have to take points off.
<br>
**DO NOT** submit a *.docx* or *.pdf* file.
<br>
**DO NOT** submit any `.class` files or any of the `csv` files.
<br>
**DO NOT** submit any of the provided interfaces. We will use the ones
we provide for testing.

#### Copying the files 
You will likely want to submit the files from your own laptop/computer.
To copy the files from `goldengate` to your own machine, 
open up a terminal on your own computer. If you have a mac or linux, you can use the 
Terminal application, if you have a windows you can use the Powershell app.

Run the following command:

```bassh
$ scp <username>@goldengate.cs.brynmawr.edu/home/<username>/cs151/homeworks/hw00/*
```

Make sure to replace `<username>` with your username. `scp` is a command to secure-copy files
from one server to another. In this case, from `goldengate` to your own machine.

This assignment was adapted from Baojian Hua's Formal Methods Foundation course at USTC.
